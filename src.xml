

Sub borne()
'
' borne Macro
'
' Touche de raccourci du clavier: Ctrl+b
'

'refreshDyn

courant = Sheets("_c").Cells(1, 10).Value
Dim last As Integer
last = 0

Dim i As Integer

For i = courant To 10000
last = last + 1
 If Sheets("_c").Cells(i, 1) <= 0 Then
 Exit For
 End If
Next

borneP10 = 10 * Int(last / 10)
If borneP10 < last Then borneP10 = borneP10 + 10

borneMV = borneP10 - 60
borneMCV = borneP10 - 160




calc "cV", borneMV, borneP10
calc "c", courant, borneP10
calc "cCV", borneMCV, borneP10

    
 
End Sub

Sub calc(ByVal sheet As String, ByVal borneM As Integer, ByVal borneP As Integer)
    
    If borneM < 2 Then borneM = 2
    Sheets(sheet).Select
    
    setBorne 1, "A", borneM, borneP
    setBorne 2, "I", borneM, borneP
    setBorne 3, "F", borneM, borneP
    setBorne 4, "E", borneM, borneP
    
    setBorneX 1, borneM
    setBorneX 2, borneM

End Sub


Sub setBorne(ByVal index As Integer, ByVal col As String, ByVal borneM As Integer, ByVal borneP As Integer)

ActiveChart.SeriesCollection(index).Values = "=_c!$" + col + "$" + CStr(borneM) + ":$" + col + "$" + CStr(borneP)

End Sub

Sub setBorneX(ByVal index As Integer, ByVal borneM As Integer)

ActiveChart.SeriesCollection(index).XValues = "=_c!$H$" + CStr(borneM) + ":$H$10000"

End Sub
                 
mise à l'échelle
     E1 =B2-D1*C2
données E (convergence)      =SI(C2=0;E1;$D$1*C2+$E$1)
