D1	0.1
E1	=K1-D1*N1
J1	2
K1	0.015
N1	==C740
01	8

--------------
E2	=SI(C2=0;E1;$D$1*(C2-$C$2)+$K$1)
F2	=SI(B2=0;F1;B2)
I2	=SI(A3<A2;0;A2)

--------------

J3	=SI(B3<B2;1;SI(B3>B2;-1;J2))






Sub borne()
'
' borne Macro
'
' Touche de raccourci du clavier: Ctrl+b
'

refreshDyn

courant = Sheets("_c").Cells(1, 10).Value
Dim last As Integer
last = courant

Dim i As Integer

For i = courant To 10000

 If Sheets("_c").Cells(i, 1) <= 0 Then
 Exit For

 End If
  last = i
Next

Sheets("_c").Cells(1, 11).Value = Sheets("_c").Cells(last, 2)

borneP10 = 10 * Int(last / 10)
If borneP10 < last Then borneP10 = borneP10 + 10

borneP20 = 20 * Int(last / 20)
If borneP20 < last Then borneP20 = borneP20 + 20

borneP50 = 50 * Int(last / 50)
If borneP50 < last Then borneP50 = borneP50 + 50

borneP100 = 100 * Int(last / 100)
If borneP100 < last Then borneP100 = borneP100 + 100

borneMV = borneP10 - 60
borneMC = borneP10 - 110
borneMCV = borneP10 - 160
borneM5C = borneP50 - 550



calc "cXX", last - 20, last
calc "cV", last - 50, last
calc "c", courant, last
calc "cC", last - 100, last
calc "cCV", borneMCV, last
calc "c2C", borneP20 - 220, last
calc "c5C", borneM5C, last
calc "cM5C", borneP100 - 1600, last
'calc "c5M", borneP100 - 5100, last
calc "c5M", last - 5000, last


    
 
End Sub

Sub calc(ByVal sheet As String, ByVal borneM As Integer, ByVal borneP As Integer)
    
    If borneM < 2 Then borneM = 2
    'Sheets(sheet).Select
    
    setBorne 1, "A", borneM, borneP, sheet
   
    setBorne 2, "I", borneM, borneP, sheet
    setBorne 3, "F", borneM, borneP, sheet
    setBorne 4, "E", borneM, borneP, sheet
    
    setBorneX 1, borneM, sheet
    setBorneX 2, borneM, sheet
    
    setBorneY 1, 0, borneM, borneP, sheet, False
    setBorneY 6, 5, borneM, borneP, sheet, True

End Sub


Sub setBorne(ByVal index As Integer, ByVal col As String, ByVal borneM As Integer, ByVal borneP As Integer, ByVal sheet As String)

Sheets(sheet).SeriesCollection(index).Values = "=_c!$" + col + "$" + CStr(borneM) + ":$" + col + "$" + CStr(borneP)

End Sub

Sub setBorneX(ByVal index As Integer, ByVal borneM As Integer, ByVal sheet As String)

Sheets(sheet).SeriesCollection(index).XValues = "=_c!$H$" + CStr(borneM) + ":$H$10000"

End Sub

Sub setBorneY(ByVal col As Integer, ByVal col2 As Integer, ByVal borneM As Integer, ByVal borneP As Integer, ByVal sheet As String, ByVal secondAxe As Boolean)
Min = Sheets("_c").Cells(borneM, col)
Max = Min

For i = borneM To borneP
    y = Sheets("_c").Cells(i, col)
    y2 = y
    If col2 > 0 Then y2 = Sheets("_c").Cells(i, col2)
    If y > Max Then
            Max = y
        Else:
            If y < Min Then
                Min = y
        End If
    End If
    If y2 > Max Then
            Max = y2
        Else:
            If y2 > 0 And y2 < Min Then
            Min = y2
        End If
    
    End If
    
Next

If Min = Max Then GoTo Ex
Delta = (Max - Min) / Sheets("_c").Cells(1, 15)
coeff = 1
While Delta < 1
    Delta = Delta * 10
    coeff = 10 * coeff
Wend

While Delta > 10
    Delta = Delta / 10
    coeff = 0.1 * coeff
Wend

'1.235
If Delta > 5 Then
    Delta = 10
Else:
    If Delta > 2 Then
    Delta = 5
Else:
    Delta = 2
End If
End If
minv = Int(coeff * Min)
maxv = Int(coeff * Max) + 1

minv = Int(minv / Delta) * Delta

courant = minv
While courant < maxv
courant = courant + Delta
Wend

borneMin = minv / coeff
borneMax = courant / coeff

If secondAxe Then
Sheets(sheet).Axes(xlValue, xlSecondary).MinimumScale = borneMin
Sheets(sheet).Axes(xlValue, xlSecondary).MaximumScale = borneMax
Sheets(sheet).Axes(xlValue, xlSecondary).MajorUnit = Delta / coeff
Else

Sheets(sheet).Axes(xlValue).MinimumScale = borneMin
Sheets(sheet).Axes(xlValue).MaximumScale = borneMax
Sheets(sheet).Axes(xlValue).MajorUnit = Delta / coeff
End If

Ex:
End Sub
